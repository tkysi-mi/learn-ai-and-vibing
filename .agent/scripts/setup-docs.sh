#!/bin/bash

# setup-docs.sh
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã‚’ä½œæˆã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

set -e

DOCS_DIR="docs"

echo "ðŸ“‚ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ§‹é€ ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚’é–‹å§‹ã—ã¾ã™..."

# 1. ç¾åœ¨ã®çŠ¶æ…‹ç¢ºèª
if [ -d "$DOCS_DIR" ]; then
  echo "âš ï¸  '$DOCS_DIR' ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¯æ—¢ã«å­˜åœ¨ã—ã¾ã™ã€‚"
  read -p "æ—¢å­˜ã®æ§‹é€ ã‚’ä¿æŒã—ãŸã¾ã¾ã€ä¸è¶³ã—ã¦ã„ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’è¿½åŠ ã—ã¾ã™ã‹ï¼Ÿ (y/N): " confirm
  if [[ ! "$confirm" =~ ^[Yy]$ ]]; then
    echo "âŒ ä¸­æ–­ã—ã¾ã—ãŸã€‚"
    exit 0
  fi
fi

# 2. ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã®ä½œæˆ
echo "ðŸ”¨ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆä¸­..."
mkdir -p "$DOCS_DIR/project/01-requirements"
mkdir -p "$DOCS_DIR/project/02-behavior"
mkdir -p "$DOCS_DIR/project/03-domain"
mkdir -p "$DOCS_DIR/project/04-design"
mkdir -p "$DOCS_DIR/tasks"

# 3. docs/README.md ã®ä½œæˆ
README_FILE="$DOCS_DIR/README.md"
if [ -f "$README_FILE" ]; then
  echo "âš ï¸  '$README_FILE' ã¯æ—¢ã«å­˜åœ¨ã—ã¾ã™ã€‚"
  read -p "ä¸Šæ›¸ãã—ã¾ã™ã‹ï¼Ÿ (y/N): " confirm_readme
  if [[ ! "$confirm_readme" =~ ^[Yy]$ ]]; then
    echo "â„¹ï¸  READMEã®ä½œæˆã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¾ã—ãŸã€‚"
  else
    CREATE_README=true
  fi
else
  CREATE_README=true
fi

if [ "$CREATE_README" = true ]; then
  echo "ðŸ“ README.md ã‚’ä½œæˆä¸­..."
  cat > "$README_FILE" <<EOF
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

ã“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã¯ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¨å€‹åˆ¥ã‚¿ã‚¹ã‚¯ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’ç®¡ç†ã—ã¾ã™ã€‚

## æ§‹æˆ

### project/
ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã€‚è¦ä»¶å®šç¾©ã€è¨­è¨ˆã€ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãªã©ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚¹ã‚³ãƒ¼ãƒ—å…¨ä½“ã«é–¢ã‚ã‚‹æƒ…å ±ã‚’è¨˜è¼‰ã—ã¾ã™ã€‚

- **01-requirements/**: è¦ä»¶å®šç¾©ï¼ˆã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦ã€æ©Ÿèƒ½è¦ä»¶ã€éžæ©Ÿèƒ½è¦ä»¶ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ãªã©ï¼‰
- **02-behavior/**: æŒ¯ã‚‹èˆžã„å®šç¾©ï¼ˆã‚·ãƒŠãƒªã‚ªã€ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¸ãƒ£ãƒ¼ãƒ‹ãƒ¼ãªã©ï¼‰
- **03-domain/**: ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ï¼ˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã€ç”¨èªžé›†ãªã©ï¼‰
- **04-design/**: è¨­è¨ˆï¼ˆã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã€ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«ã€APIä»•æ§˜ãªã©ï¼‰

### tasks/
å€‹åˆ¥ã‚¿ã‚¹ã‚¯ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã€‚Issue ã‚„ãƒã‚±ãƒƒãƒˆå˜ä½ã§ä½œæˆã—ã¾ã™ã€‚

## æ›´æ–°æ–¹é‡

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ (project/)
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚¹ã‚³ãƒ¼ãƒ—å…¨ä½“ã«å½±éŸ¿ã™ã‚‹æƒ…å ±ã‚’è¨˜è¼‰
- ãƒãƒ¼ãƒ å…¨ä½“ã§å…±æœ‰ã™ã¹ãè¦ä»¶ãƒ»è¨­è¨ˆãƒ»ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’ç®¡ç†
- æ›´æ–°æ™‚ã¯é–¢ä¿‚è€…ã«ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’ä¾é ¼

### å€‹åˆ¥ã‚¿ã‚¹ã‚¯ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ (tasks/)
- ç‰¹å®šã® Issue ã‚„ãƒã‚±ãƒƒãƒˆã«ç´ã¥ãæƒ…å ±ã‚’è¨˜è¼‰
- ã‚¿ã‚¹ã‚¯å˜ä½ã§ä½œæˆãƒ»å®Œäº†ãƒ»ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–
- å®Œäº†å¾Œã¯å‚ç…§è³‡æ–™ã¨ã—ã¦ä¿æŒã€ã¾ãŸã¯å‰Šé™¤

## ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

- **å…·ä½“çš„**: æŠ½è±¡çš„ãªè¡¨ç¾ã‚’é¿ã‘ã€æ•°å€¤ãƒ»æœŸé™ãƒ»åˆ¶ç´„ã‚’æ˜Žç¢ºã«è¨˜è¼‰
- **æ¸¬å®šå¯èƒ½**: æˆåŠŸåŸºæº–ã‚„ãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹ç›®æ¨™ã‚’å®šé‡åŒ–
- **æœ€æ–°**: å¤‰æ›´ãŒã‚ã‚Œã°é€Ÿã‚„ã‹ã«æ›´æ–°ã—ã€å¤ã„æƒ…å ±ã‚’æ®‹ã•ãªã„
- **ç°¡æ½”**: å¿…è¦æœ€ä½Žé™ã®æƒ…å ±ã«çµžã‚Šã€è©³ç´°ã¯ã‚³ãƒ¼ãƒ‰ã‚„ãƒªãƒ³ã‚¯å…ˆã«å§”ã­ã‚‹
EOF
fi

# 4. å®Œäº†å ±å‘Š
echo ""
echo "âœ… ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãŒå®Œäº†ã—ã¾ã—ãŸï¼"
echo ""
find "$DOCS_DIR" -maxdepth 2 | sort
echo ""
echo "æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—:"
echo "  - å¿…è¦ã«å¿œã˜ã¦ 'git add $DOCS_DIR' ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚"
